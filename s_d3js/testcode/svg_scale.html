<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3JS,比例尺</title>
        <script type="text/javascript" src="../d3/d3.js"></script>
    </head>
    <body>
        <h1>比例尺说明</h1>
        <p>
            比例尺是一组把输入域映射为输出范围的函数。</br>
            D3的比例尺就是那些你定义的带有参数的函数。定义好之后，就可以调用这些比例尺函数，传入值，就能返回按比例生成的输出值。</br>
            坐标轴只是比例尺的一种形象表示，与比例尺是两样东西。</br>
            比例尺包括<strong>输入值域</strong>和<strong>输出范围</strong>。
        </p>
        <h1>示例</h1>
        <div class="example"></div>
        <script type="text/javascript">
            // 创建SVG
            var w = 500;
            var h = 400;
            var padding = 20;   // 定义边距
            var svg = d3.select("body div.example")
                        .append("svg")
                        .attr("width", w)
                        .attr("height", h);
            // 创建示例数据,每个元素第1值为x,第2个值为y
            var dataset = [[5,20], [480, 90], [250, 50], [100, 33], [330,95], [410,12], [475, 44], [25, 67], [85, 21], [220, 88]];
            // 线性比例尺示例，无实际用途
            var scale = d3.scaleLinear()    // 定义一个线性比例尺, V3版为d3.scale.linear()
                          .domain([100, 500])  // 指定比例尺的输入值域为100-500，必须用数组包装
                          .range([10, 350])    // 指定比例尺的输出范围为10-350
            // 定义一个动态的线性比例尺，做为x轴
            var xScale = d3.scaleLinear()
                          .domain([0, d3.max(dataset, function(d){return d[0];})])
                          .range([padding , w - padding * 3]);  // 左边距padding, 右边距 padding*3
            // 定义y轴的比例尺
            var yScale = d3.scaleLinear()
                           .domain([0, d3.max(dataset, function(d){return d[1];})])
                           .range([h - padding, padding]);    // 注意，反转了y轴的输出域
            // 定义半径的比例尺
            var rScale = d3.scaleLinear()
                           .domain([0, d3.max(dataset, function(d){return d[1];})])
                           .range([2, 5])
            // 创建散点图
            svg.selectAll("circle")
               .data(dataset)
               .enter()
               .append("circle")
               .attr("cx", function(d){return xScale(d[0]);})
               .attr("cy", function(d){return yScale(d[1]);})
               .attr("r", function(d){return rScale(d[1]);});
            svg.selectAll("text")
               .data(dataset)
               .enter()
               .append("text")
               .attr("x", function(d){return xScale(d[0] + 5);})
               .attr("y", function(d){return yScale(d[1] - 5);})
               .attr("font-family", "sans-serif")
               .attr("font-size", "12px")
               .attr("fill", "red")
               .text(function(d){return d[0] + "," + d[1]});
            var xAxis = d3.svg.axis();
            xAxis.scale(xScale);
            xAxis.orient("bottom");
            svg.append("g").call(xAxis);
        </script>
    </body>
</html>